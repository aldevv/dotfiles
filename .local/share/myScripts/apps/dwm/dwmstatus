#!/bin/bash
#change to dash
updateCheck() {
    var=$(sudo eopkg ur)
    packages="$(sudo eopkg lu | wc -l)æ›´æ–°"
    if [[ $packages == "1æ›´æ–°" ]]; then
        # packages=""
        printf ""
    else
        printf "| %s" "$packages"
    fi
}
declare -A days
days[Mon]="æœˆ"
days[Tue]="ç«"
days[Wed]="æ°´"
days[Thu]="æœ¨"
days[Fri]="é‡‘"
days[Sat]="åœŸ"
days[Sun]="æ—¥"

while true; do
    time=$(date +'%H:%M')
    day=$(date +'%a')
    date=$(date +"%dæ—¥%mæœˆ%yå¹´ (${days[${day}]})")

    battery="$(upower -i /org/freedesktop/UPower/devices/battery_BAT0 | awk '/percentage/{print $2}' | tr -d "%")é›»"
    charging=$(upower -i /org/freedesktop/UPower/devices/battery_BAT0 | grep state | cut -d: -f2 | tr -d " ")
    if [[ $battery =~ ^[0-9]é›» ]] && [[ $charging != "charging" ]]; then dunstify "Low Battery"; fi


    volume="$(amixer sget Master | awk -F"[][]" '/\[[0-9]/{ print $2 }' | sed 1q | tr -d "%")éŸ³"

    [[ -z "$packages" ]] && packages=$(updateCheck) || packages=""

    #wifi connected
    # [[ $(nmcli d status | sed -n '2p' | cut -d" " -f 9) == "connected" ]] && internet=ğŸ¥ ||internet=ğŸ¡

	xsetroot -name "${packages} | ${volume} | ${battery} | ${time} | ${date}"
	# xsetroot -name "| ${internet} | ${packages} | ${volume} | ${battery} | ${time} | ${date}"
	sleep 1m
done
